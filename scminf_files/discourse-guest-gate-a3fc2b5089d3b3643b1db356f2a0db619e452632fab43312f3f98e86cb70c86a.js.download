define("discourse/plugins/guest-gate/discourse/components/d-gate",["exports","ember-addons/ember-computed-decorators","discourse/components/d-modal"],(function(e,t,o){"use strict";var a,n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,r,s,l,c,d,u=o.default.extend((a=(0,t.on)("didInsertElement"),i=n={classNameBindings:[":gate"],attributeBindings:["data-keyboard"],dismissable:!1,"data-keyboard":"true",setUp:function(){var e=this;this.appEvents.on("modal:body-shown",(function(t){t.title&&e.set("title",I18n.t(t.title)),$("html").addClass("gg-active"),e._modalBodyShown(t)})),this.appEvents.on("modal:body-dismissed",(function(e){$("html").removeClass("gg-active")})),$("html").on("keydown.discourse-modal",(function(e){27===e.which&&$(".modal-header a.close").is(":visible")&&Em.run.next((function(){return $(".modal-header a.close").click()}))}))},click:function(e){var t=$(e.target);(t.hasClass("modal-middle-container")||t.hasClass("modal-outer-container"))&&$(".modal-header a.close").is(":visible")&&$(".modal-header a.close").click()}},r="setUp",s=[a],l=Object.getOwnPropertyDescriptor(n,"setUp"),c=n,d={},Object.keys(l).forEach((function(e){d[e]=l[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=s.slice().reverse().reduce((function(e,t){return t(i,r,e)||e}),d),c&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(c):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(i,r,d),d=null),n));e.default=u})),define("discourse/plugins/guest-gate/discourse/controllers/guest-gate",["exports","discourse/mixins/modal-functionality","discourse/lib/computed"],(function(e,t,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=Ember.Controller.extend(t.default,{login:Ember.inject.controller(),ssoEnabled:(0,o.setting)("enable_sso"),actions:{externalLogin:function(e){this.get("login").send("externalLogin",e)}}});e.default=a})),define("discourse/plugins/guest-gate/discourse/initializers/guest-gate",["exports","discourse/lib/clean-dom","discourse/lib/page-tracker","discourse/lib/ajax","discourse/plugins/guest-gate/discourse/lib/show-gate"],(function(e,t,o,a,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"guest-gate",after:"inject-objects",initialize:function(e){if(Discourse.SiteSettings.guest_gate_enabled&&!Discourse.User.current()){var i=0,r=e.lookup("router:main");r.on("willTransition",a.viewTrackingRequired),r.on("didTransition",t.cleanDOM);var s=e.lookup("app-events:main");(0,o.startPageTracking)(r,s);var l=!1;s.on("page:changed",(function(e){var t,o;if(new RegExp("^/t/").test(e.url)){var a=!1;new RegExp("(googlebot/|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)","i").test(navigator.userAgent)&&(a=!0);var r=parseInt(Discourse.SiteSettings.max_guest_topic_views);++i>=r&&!a&&!l&&(Discourse.SiteSettings.gate_show_only_once&&(l=!0),t=0,o=r+1,t=Math.ceil(t),o=Math.floor(o),i=Math.floor(Math.random()*(o-t))+t,(0,n.default)("guest-gate"))}}))}}};e.default=i})),define("discourse/plugins/guest-gate/discourse/lib/show-gate",["exports"],(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){t=t||{};var o=Discourse.__container__,a=o.lookup("route:application"),n=a.controllerFor("modal");n.set("modalClass","gate");var i=t.admin?"modals/".concat(e):e,r=o.factoryFor("view:"+e),s=o.lookup("controller:"+i);if(r)a.render(e,{into:"modal",outlet:"modalBody"});else{var l=t.templateName||Ember.String.dasherize(e),c={into:"modal",outlet:"modalBody"};s&&(c.controller=i),t.addModalBodyView&&(c.view="modal-body");var d="".concat(l),u=t.admin?"admin/templates/".concat(d):d;a.render(u,c),t.title&&n.set("title",I18n.t(t.title))}if(s){s.set("modal",n);var m=t.model;m&&s.set("model",m),s.onShow&&s.onShow(),s.set("flashMessage",null)}return s}})),Ember.TEMPLATES["javascripts/guest-gate"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title","class"],["guest_gate.modal.title","guest-gate"]],{"statements":[[4,"if",[[24,["siteSettings","custom_gate_enabled"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","custom-gate"],[8],[0,"\\n      "],[7,"img",true],[11,"src",[29,[[24,["siteSettings","custom_gate_image_url"]]]]],[8],[9],[0,"\\n      "],[7,"h1",true],[11,"style",[29,["color:",[24,["siteSettings","custom_gate_big_text_color"]]]]],[8],[0,"\\n        "],[1,[24,["siteSettings","custom_gate_big_text"]],false],[0,"\\n      "],[9],[0,"\\n      "],[7,"h4",true],[8],[0,"\\n        "],[7,"span",true],[11,"style",[29,["color:",[24,["siteSettings","custom_gate_little_text_color"]]]]],[8],[0,"\\n          "],[1,[24,["siteSettings","custom_gate_little_text"]],false],[0,"\\n        "],[9],[0,"\\n      "],[9],[0,"\\n    "],[9],[0,"\\n    "],[7,"style",true],[10,"type","text/css"],[8],[0,"\\n      .custom-gate {\\n        text-align: center;\\n      }\\n      .custom-gate img {\\n        width: 60%;\\n      }\\n      .custom-gate h1 {\\n        margin-top: 4%;\\n      }\\n      .custom-gate h4 {\\n        margin-top: 4%;\\n        margin-bottom: 4%;\\n      }\\n      .modal-footer {\\n        text-align: center;\\n        color: "],[1,[24,["siteSettings","custom_gate_link_color"]],false],[0," !important;\\n      }\\n      .modal-footer a {\\n        color: "],[1,[24,["siteSettings","custom_gate_link_color"]],false],[0," !important;\\n      }\\n      .modal-inner-container {\\n        background-color: "],[1,[24,["siteSettings","custom_gate_background_color"]],false],[0," !important;\\n      }\\n    "],[9],[0,"\\n"]],"parameters":[]},{"statements":[[0,"    "],[7,"div",true],[8],[0,"\\n      "],[7,"p",true],[8],[1,[28,"replace-emoji",[[28,"i18n",["signup_cta.intro"],null]],null],false],[9],[0,"\\n      "],[7,"p",true],[8],[1,[28,"replace-emoji",[[28,"i18n",["signup_cta.value_prop"],null]],null],false],[9],[0,"\\n    "],[9],[0,"\\n"]],"parameters":[]}],[0,"  "],[7,"style",true],[10,"type","text/css"],[8],[0,"\\n    .gate .modal-header {\\n      border-bottom: none;\\n    }\\n    .gate .modal-header .close {\\n"],[4,"if",[[24,["siteSettings","x_button_disabled"]]],null,{"statements":[[0,"      display: none;\\n"]],"parameters":[]},{"statements":[[0,"      margin-top: 15px;\\n"]],"parameters":[]}],[0,"    }\\n    .modal .modal-body p {\\n      font-size: 14px;\\n    }\\n    #login-buttons {\\n      margin-bottom: 0;\\n      text-align: center;\\n    }\\n    .mobile-view #login-buttons {\\n      width: 100%;\\n    }\\n    .mobile-view .btn-social {\\n      width: 100%;\\n      margin-top: 3px;\\n    }\\n    .modal-footer {\\n      text-align: center;\\n      color: #787878;\\n    }\\n    .modal-footer a {\\n      color: #787878;\\n    }\\n  "],[9],[0,"\\n  "],[1,[28,"login-buttons",null,[["externalLogin"],[[28,"action",[[23,0,[]],"externalLogin"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[7,"div",true],[10,"class","modal-footer"],[8],[0,"\\n"],[4,"if",[[24,["ssoEnabled"]]],null,{"statements":[[0,"    "],[1,[28,"d-button",null,[["label","action"],["guest_gate.modal.log_in","showLogin"]]],false],[0,"\\n      or \\n    "],[1,[28,"d-button",null,[["label","action"],["guest_gate.modal.sign_up","showCreateAccount"]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"  "],[7,"a",false],[12,"href",""],[3,"action",[[23,0,[]],"showLogin"]],[8],[1,[28,"i18n",["log_in"],null],false],[9],[0," |\\n  "],[7,"a",false],[12,"href",""],[3,"action",[[23,0,[]],"showCreateAccount"]],[8],[1,[28,"i18n",["create_account.title"],null],false],[9],[0,"\\n"]],"parameters":[]}],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/guest-gate"}}),Ember.TEMPLATES["javascripts/modal"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["error"],"statements":[[4,"d-gate",null,[["modalClass","title","class"],[[24,["modalClass"]],[24,["title"]],"gg-hide-modal"]],{"statements":[[0,"  "],[7,"div",true],[10,"class","modal-outer-container"],[8],[0,"\\n    "],[7,"div",true],[10,"class","modal-middle-container"],[8],[0,"\\n      "],[7,"div",true],[10,"class","modal-inner-container"],[8],[0,"\\n        "],[7,"div",true],[10,"class","modal-header"],[8],[0,"\\n          "],[7,"h3",true],[8],[1,[22,"title"],false],[9],[0,"\\n          "],[7,"div",true],[10,"class","modal-close"],[8],[0,"\\n            "],[7,"a",false],[12,"class","close"],[3,"action",[[23,0,[]],"closeModal"]],[8],[1,[28,"d-icon",["times"],null],false],[9],[0,"\\n          "],[9],[0,"\\n        "],[9],[0,"\\n        "],[7,"div",true],[10,"id","modal-alert"],[8],[9],[0,"\\n        "],[1,[28,"outlet",["modalBody"],null],false],[0,"\\n"],[4,"each",[[24,["errors"]]],null,{"statements":[[0,"          "],[7,"div",true],[10,"class","alert alert-error"],[8],[0,"\\n            "],[7,"button",true],[10,"class","close"],[10,"data-dismiss","alert"],[8],[0,"×"],[9],[0,"\\n            "],[1,[23,1,[]],false],[0,"\\n          "],[9],[0,"\\n"]],"parameters":[1]},null],[0,"      "],[9],[0,"\\n    "],[9],[0,"\\n"],[9],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/modal"}});